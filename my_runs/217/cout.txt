INFO - UNet_Speech_Separation - Running command 'do_experiment'
INFO - UNet_Speech_Separation - Started run with ID "217"
Experiment ID: 217
Preparing dataset
Dataset ready
2018-11-13 17:17:52.649988: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-11-13 17:17:53.780250: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-11-13 17:17:53.781022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:26:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-11-13 17:17:53.781037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0
2018-11-13 17:17:54.047395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-13 17:17:54.047433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 
2018-11-13 17:17:54.047439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N 
2018-11-13 17:17:54.047683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10404 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:26:00.0, compute capability: 6.1)
Session started
Iterators created
Creating model
Loading checkpoint
INFO:tensorflow:Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/211/211-2
INFO - tensorflow - Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/211/211-2
Starting training
2018-11-13 17:18:13.836340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 348 of 1000
2018-11-13 17:18:23.766069: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 798 of 1000
2018-11-13 17:18:28.318786: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 17:22:28.227479:	Training iteration: 200, Loss: 0.0016168656293302774
2018-11-13 17:26:23.382706:	Training iteration: 400, Loss: 0.0018027189653366804
2018-11-13 17:28:08.139262: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2018-11-13 17:28:17.996516: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 785 of 1000
2018-11-13 17:28:23.626971: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 17:30:24.575492:	Training iteration: 600, Loss: 0.0017529695760458708
2018-11-13 17:34:21.202916:	Training iteration: 800, Loss: 0.0017946487059816718
2018-11-13 17:38:05.000613: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 301 of 1000
2018-11-13 17:38:14.885068: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 497 of 1000
2018-11-13 17:38:24.850334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 943 of 1000
2018-11-13 17:38:26.195009: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 17:38:33.238571:	Training iteration: 1000, Loss: 0.0018931786762550473
2018-11-13 17:42:33.966781:	Training iteration: 1200, Loss: 0.002052144380286336
2018-11-13 17:46:36.914456:	Training iteration: 1400, Loss: 0.0018156629521399736
2018-11-13 17:48:15.518980: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 359 of 1000
2018-11-13 17:48:25.440302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 778 of 1000
2018-11-13 17:48:30.380387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 17:50:45.424104:	Training iteration: 1600, Loss: 0.0016795950941741467
2018-11-13 17:54:36.376279:	Training iteration: 1800, Loss: 0.0015615656739100814
2018-11-13 17:58:48.732757:	Training iteration: 2000, Loss: 0.0017129306215792894
2018-11-13 17:58:53.298505:	Epoch 0 finished after 2016 iterations.
Validating
2018-11-13 17:58:53.487111:	Entering validation loop
2018-11-13 17:59:03.792854: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 213 of 1000
2018-11-13 17:59:13.910146: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 619 of 1000
2018-11-13 17:59:22.657507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:00:57.642977: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-13 18:01:07.539621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-13 18:01:12.003104: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:02:40.585509: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2018-11-13 18:02:50.452209: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2018-11-13 18:02:55.315240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:03:34.834399:	Validation iteration: 200, Loss: 0.0017699317540973425
2018-11-13 18:04:27.135327: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 373 of 1000
2018-11-13 18:04:37.287039: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 18:04:41.774424: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.001470596382638351
Validation loss has improved!
New best validation cost!
Checkpoint
2018-11-13 18:06:11.339028: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 382 of 1000
2018-11-13 18:06:21.441682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 833 of 1000
2018-11-13 18:06:25.093079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:09:59.551399:	Training iteration: 2200, Loss: 0.0017923632403835654
2018-11-13 18:14:31.654126:	Training iteration: 2400, Loss: 0.0018914067186415195
2018-11-13 18:16:34.459267: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 369 of 1000
2018-11-13 18:16:44.374503: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 694 of 1000
2018-11-13 18:16:51.669455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:18:35.856611:	Training iteration: 2600, Loss: 0.0018515473930165172
2018-11-13 18:22:29.727710:	Training iteration: 2800, Loss: 0.0017165504395961761
2018-11-13 18:26:22.762979:	Training iteration: 3000, Loss: 0.0016777425771579146
2018-11-13 18:26:35.590963: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 386 of 1000
2018-11-13 18:26:45.557431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 811 of 1000
2018-11-13 18:26:49.543290: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:30:32.441517:	Training iteration: 3200, Loss: 0.0021349943708628416
2018-11-13 18:34:24.267852:	Training iteration: 3400, Loss: 0.001827362459152937
2018-11-13 18:36:27.509553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 366 of 1000
2018-11-13 18:36:37.561872: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2018-11-13 18:36:42.046426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:38:35.787229:	Training iteration: 3600, Loss: 0.0014775360468775034
2018-11-13 18:42:38.300932:	Training iteration: 3800, Loss: 0.0017831732984632254
2018-11-13 18:46:34.998450:	Training iteration: 4000, Loss: 0.0016627706354483962
2018-11-13 18:46:51.170959:	Epoch 1 finished after 4031 iterations.
Validating
2018-11-13 18:46:51.173198:	Entering validation loop
2018-11-13 18:47:01.257370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 376 of 1000
2018-11-13 18:47:11.174028: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 808 of 1000
2018-11-13 18:47:15.521648: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:48:43.294331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 377 of 1000
2018-11-13 18:48:53.355883: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 18:48:57.714757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:50:23.751468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2018-11-13 18:50:33.855404: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 18:50:38.224681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:51:17.579324:	Validation iteration: 200, Loss: 0.0014072590274736285
2018-11-13 18:52:06.404022: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 380 of 1000
2018-11-13 18:52:16.437577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 814 of 1000
2018-11-13 18:52:20.666134: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.0014694401934754015
Validation loss has improved!
New best validation cost!
Checkpoint
Training complete after 2 epochs.
Finished requested number of epochs.
Final validation loss: 0.0014694401934754015
This was the best validation loss achieved
Starting testing
2018-11-13 18:53:46.780168:	Entering test loop
2018-11-13 18:53:57.083938: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2018-11-13 18:54:07.181413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 18:54:11.784189: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 18:54:15.535756:	Testing iteration: 0, Loss: 0.0013292490039020777
2018-11-13 18:57:16.083684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 378 of 1000
2018-11-13 18:57:26.088639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 674 of 1000
2018-11-13 18:57:36.046362: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 912 of 1000
2018-11-13 18:57:39.316319: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 19:00:55.619591: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-13 19:01:05.738689: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 739 of 1000
2018-11-13 19:01:15.263092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 19:04:19.847632: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-13 19:04:29.899130: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 752 of 1000
2018-11-13 19:04:38.108170: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 19:04:57.209337:	Testing iteration: 200, Loss: 0.001370731508359313
Test pass complete
Mean loss over test set: 0.0012438790751800228
Data saved to dumps/217 for later audio metric calculation
2018-11-13 19:07:42.182472:
	All done with experiment 217!
	Final test loss: 0.0012438790751800228
