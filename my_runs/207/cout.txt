INFO - UNet_Speech_Separation - Running command 'do_experiment'
INFO - UNet_Speech_Separation - Started run with ID "207"
Experiment ID: 207
Preparing dataset
Dataset ready
2018-11-12 14:15:00.322084: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-11-12 14:15:01.565781: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-11-12 14:15:01.566561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:26:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-11-12 14:15:01.566577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0
2018-11-12 14:15:01.858828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-12 14:15:01.858864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 
2018-11-12 14:15:01.858870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N 
2018-11-12 14:15:01.859117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10404 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:26:00.0, compute capability: 6.1)
Session started
Iterators created
Creating model
Loading checkpoint
INFO:tensorflow:Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/184/184-8
INFO - tensorflow - Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/184/184-8
Starting training
2018-11-12 14:15:21.474550: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 370 of 1000
2018-11-12 14:15:31.449096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 823 of 1000
2018-11-12 14:15:35.423641: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:19:28.797019:	Training iteration: 200, Loss: 0.01403547078371048
2018-11-12 14:23:17.869765:	Training iteration: 400, Loss: 0.01655600219964981
2018-11-12 14:24:56.949524: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 370 of 1000
2018-11-12 14:25:07.007709: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2018-11-12 14:25:12.378639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:27:11.699825:	Training iteration: 600, Loss: 0.023274242877960205
2018-11-12 14:31:00.569739:	Training iteration: 800, Loss: 0.019333776086568832
2018-11-12 14:34:34.171014: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 370 of 1000
2018-11-12 14:34:44.255308: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 804 of 1000
2018-11-12 14:34:48.709487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:34:55.619959:	Training iteration: 1000, Loss: 0.021396148949861526
2018-11-12 14:38:43.298102:	Training iteration: 1200, Loss: 0.02503218874335289
2018-11-12 14:42:40.432256:	Training iteration: 1400, Loss: 0.018629375845193863
2018-11-12 14:44:17.366316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 360 of 1000
2018-11-12 14:44:27.356055: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 785 of 1000
2018-11-12 14:44:32.111952: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:46:34.341087:	Training iteration: 1600, Loss: 0.02191511169075966
2018-11-12 14:50:23.776543:	Training iteration: 1800, Loss: 0.016478074714541435
2018-11-12 14:54:12.252541:	Training iteration: 2000, Loss: 0.016422729939222336
2018-11-12 14:54:15.888511:	Epoch 0 finished after 2016 iterations.
Validating
2018-11-12 14:54:16.082793:	Entering validation loop
2018-11-12 14:54:26.443250: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-12 14:54:36.384970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 808 of 1000
2018-11-12 14:54:40.629313: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:56:05.410759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 213 of 1000
2018-11-12 14:56:15.539799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 636 of 1000
2018-11-12 14:56:23.787168: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:57:47.902080: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 378 of 1000
2018-11-12 14:57:57.891170: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-12 14:58:02.488081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 14:58:40.293424:	Validation iteration: 200, Loss: 0.08635793626308441
2018-11-12 14:59:28.356672: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 220 of 1000
2018-11-12 14:59:38.308987: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 647 of 1000
2018-11-12 14:59:46.396470: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.0895356435905255
Validation loss has improved!
New best validation cost!
Checkpoint
2018-11-12 15:01:17.178878: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 373 of 1000
2018-11-12 15:01:27.027089: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 831 of 1000
2018-11-12 15:01:30.658091: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:05:02.549694:	Training iteration: 2200, Loss: 0.017197495326399803
2018-11-12 15:08:54.466665:	Training iteration: 2400, Loss: 0.016489792615175247
2018-11-12 15:10:53.235200: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2018-11-12 15:11:02.971756: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 791 of 1000
2018-11-12 15:11:08.229586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:12:50.088723:	Training iteration: 2600, Loss: 0.021813591942191124
2018-11-12 15:16:35.493911:	Training iteration: 2800, Loss: 0.02479357086122036
2018-11-12 15:20:13.715717:	Training iteration: 3000, Loss: 0.01818854734301567
2018-11-12 15:20:25.944843: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-12 15:20:36.042129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-12 15:20:40.108957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:24:16.765109:	Training iteration: 3200, Loss: 0.021656086668372154
2018-11-12 15:28:06.497935:	Training iteration: 3400, Loss: 0.021057620644569397
2018-11-12 15:29:59.686275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 367 of 1000
2018-11-12 15:30:09.663175: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 799 of 1000
2018-11-12 15:30:14.218357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:32:02.405779:	Training iteration: 3600, Loss: 0.017499100416898727
2018-11-12 15:35:57.560614:	Training iteration: 3800, Loss: 0.01976178027689457
2018-11-12 15:39:49.440493:	Training iteration: 4000, Loss: 0.015325075015425682
2018-11-12 15:40:09.892585:	Epoch 1 finished after 4031 iterations.
Validating
2018-11-12 15:40:09.896173:	Entering validation loop
2018-11-12 15:40:19.937580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 382 of 1000
2018-11-12 15:40:30.200208: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 812 of 1000
2018-11-12 15:40:34.317058: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:41:58.622292: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 377 of 1000
2018-11-12 15:42:08.575644: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-12 15:42:13.257466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:43:37.755862: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 393 of 1000
2018-11-12 15:43:47.763340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 815 of 1000
2018-11-12 15:43:51.920473: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:44:28.337759:	Validation iteration: 200, Loss: 0.0895327776670456
2018-11-12 15:45:23.730428: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 378 of 1000
2018-11-12 15:45:33.715366: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 810 of 1000
2018-11-12 15:45:38.301878: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.08867193629876488
Validation loss has improved!
New best validation cost!
Checkpoint
Training complete after 2 epochs.
Finished requested number of epochs.
Final validation loss: 0.08867193629876488
This was the best validation loss achieved
Starting testing
2018-11-12 15:46:55.024829:	Entering test loop
2018-11-12 15:47:05.421919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 391 of 1000
2018-11-12 15:47:15.386289: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 815 of 1000
2018-11-12 15:47:19.763817: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:47:24.609160:	Testing iteration: 0, Loss: 0.09986367076635361
2018-11-12 15:50:36.030132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 387 of 1000
2018-11-12 15:50:45.990381: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 779 of 1000
2018-11-12 15:50:51.733555: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:54:09.117305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 385 of 1000
2018-11-12 15:54:19.086716: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 791 of 1000
2018-11-12 15:54:24.448132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:57:38.661336: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 386 of 1000
2018-11-12 15:57:48.693214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 633 of 1000
2018-11-12 15:57:57.509350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 15:58:17.299137:	Testing iteration: 200, Loss: 0.1161939948797226
Test pass complete
Mean loss over test set: 0.11006206577787032
Data saved to dumps/207 for later audio metric calculation
2018-11-12 16:01:16.305053:
	All done with experiment 207!
	Final test loss: 0.11006206577787032
