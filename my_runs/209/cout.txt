INFO - UNet_Speech_Separation - Running command 'do_experiment'
INFO - UNet_Speech_Separation - Started run with ID "209"
Experiment ID: 209
Preparing dataset
Dataset ready
2018-11-12 16:13:37.864401: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-11-12 16:13:39.132636: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-11-12 16:13:39.133415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:26:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-11-12 16:13:39.133431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0
2018-11-12 16:13:39.401711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-12 16:13:39.401749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 
2018-11-12 16:13:39.401756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N 
2018-11-12 16:13:39.402157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10404 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:26:00.0, compute capability: 6.1)
Session started
Iterators created
Creating model
Loading checkpoint
INFO:tensorflow:Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/196/196-8
INFO - tensorflow - Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/196/196-8
Starting training
2018-11-12 16:14:00.572390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 341 of 1000
2018-11-12 16:14:10.445534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 795 of 1000
2018-11-12 16:14:15.173197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:18:07.664586:	Training iteration: 200, Loss: 0.0016482650535181165
2018-11-12 16:22:00.819822:	Training iteration: 400, Loss: 0.001917476998642087
2018-11-12 16:23:42.452335: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 366 of 1000
2018-11-12 16:23:52.387194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 780 of 1000
2018-11-12 16:23:58.144358: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:25:56.418722:	Training iteration: 600, Loss: 0.001682471251115203
2018-11-12 16:29:42.984278:	Training iteration: 800, Loss: 0.0015663185622543097
2018-11-12 16:33:20.608377: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2018-11-12 16:33:30.615324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-12 16:33:34.930209: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:33:41.819933:	Training iteration: 1000, Loss: 0.0018109070369973779
2018-11-12 16:37:30.860611:	Training iteration: 1200, Loss: 0.0019186867866665125
2018-11-12 16:41:23.339360:	Training iteration: 1400, Loss: 0.001657733228057623
2018-11-12 16:43:03.876068: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 223 of 1000
2018-11-12 16:43:13.800246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 615 of 1000
2018-11-12 16:43:22.590294: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:45:28.894288:	Training iteration: 1600, Loss: 0.001685462542809546
2018-11-12 16:49:14.841876:	Training iteration: 1800, Loss: 0.0018049482023343444
2018-11-12 16:52:58.709834:	Training iteration: 2000, Loss: 0.0016423090128228068
2018-11-12 16:53:02.168773:	Epoch 0 finished after 2016 iterations.
Validating
2018-11-12 16:53:02.355368:	Entering validation loop
2018-11-12 16:53:12.625421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-12 16:53:22.703136: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-12 16:53:27.304231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:55:02.679976: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-12 16:55:12.751983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 805 of 1000
2018-11-12 16:55:17.282176: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:56:42.379916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 369 of 1000
2018-11-12 16:56:52.313450: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 797 of 1000
2018-11-12 16:56:57.047718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 16:57:34.212446:	Validation iteration: 200, Loss: 0.0015671014552935958
2018-11-12 16:58:22.601812: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-12 16:58:32.599954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 816 of 1000
2018-11-12 16:58:36.649454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.001470765891662311
Validation loss has improved!
New best validation cost!
Checkpoint
2018-11-12 17:00:13.264978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 399 of 1000
2018-11-12 17:00:23.240906: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 847 of 1000
2018-11-12 17:00:26.486326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:03:54.688531:	Training iteration: 2200, Loss: 0.0015676592011004686
2018-11-12 17:07:40.588778:	Training iteration: 2400, Loss: 0.0019807724747806787
2018-11-12 17:09:40.334785: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 376 of 1000
2018-11-12 17:09:50.430584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2018-11-12 17:09:55.535795: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:11:39.556963:	Training iteration: 2600, Loss: 0.0017294842982664704
2018-11-12 17:15:26.940658:	Training iteration: 2800, Loss: 0.0015316284261643887
2018-11-12 17:19:14.434413:	Training iteration: 3000, Loss: 0.0017140456475317478
2018-11-12 17:19:26.484639: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 364 of 1000
2018-11-12 17:19:36.495822: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 647 of 1000
2018-11-12 17:19:44.394386: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:23:32.534905:	Training iteration: 3200, Loss: 0.002177539514377713
2018-11-12 17:27:25.379989:	Training iteration: 3400, Loss: 0.001915582804940641
2018-11-12 17:29:19.471853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 362 of 1000
2018-11-12 17:29:29.500687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 788 of 1000
2018-11-12 17:29:34.471877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:31:20.644018:	Training iteration: 3600, Loss: 0.0017818909836933017
2018-11-12 17:35:09.970919:	Training iteration: 3800, Loss: 0.0015582129126414657
2018-11-12 17:39:04.205682:	Training iteration: 4000, Loss: 0.002010707976296544
2018-11-12 17:39:18.913650:	Epoch 1 finished after 4031 iterations.
Validating
2018-11-12 17:39:18.917942:	Entering validation loop
2018-11-12 17:39:29.017388: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-12 17:39:38.920099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 802 of 1000
2018-11-12 17:39:43.504077: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:41:08.652979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 213 of 1000
2018-11-12 17:41:18.630400: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 628 of 1000
2018-11-12 17:41:27.176087: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:42:58.481491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-12 17:43:08.456028: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 800 of 1000
2018-11-12 17:43:13.129301: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:43:50.225934:	Validation iteration: 200, Loss: 0.00133710284717381
2018-11-12 17:44:38.397772: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 377 of 1000
2018-11-12 17:44:48.428587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 808 of 1000
2018-11-12 17:44:52.810817: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.0014600644928924296
Validation loss has improved!
New best validation cost!
Checkpoint
Training complete after 2 epochs.
Finished requested number of epochs.
Final validation loss: 0.0014600644928924296
This was the best validation loss achieved
Starting testing
2018-11-12 17:46:09.619180:	Entering test loop
2018-11-12 17:46:19.958957: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 363 of 1000
2018-11-12 17:46:29.902615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 784 of 1000
2018-11-12 17:46:35.105748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:46:42.106328:	Testing iteration: 0, Loss: 0.001204205211251974
2018-11-12 17:49:28.812357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2018-11-12 17:49:39.982948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 690 of 1000
2018-11-12 17:49:48.744476: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 990 of 1000
2018-11-12 17:49:49.194412: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:52:38.563246: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 373 of 1000
2018-11-12 17:52:48.568193: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 786 of 1000
2018-11-12 17:52:54.874400: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:55:40.354579: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 370 of 1000
2018-11-12 17:55:51.284456: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 748 of 1000
2018-11-12 17:55:59.179333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-12 17:56:16.379087:	Testing iteration: 200, Loss: 0.0012631467543542385
Test pass complete
Mean loss over test set: 0.0012450242737451424
Data saved to dumps/209 for later audio metric calculation
2018-11-12 17:58:32.183329:
	All done with experiment 209!
	Final test loss: 0.0012450242737451424
