INFO - UNet_Speech_Separation - Running command 'do_experiment'
INFO - UNet_Speech_Separation - Started run with ID "213"
Experiment ID: 213
Preparing dataset
Dataset ready
2018-11-13 09:20:10.218442: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-11-13 09:20:10.540740: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-11-13 09:20:10.541436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:26:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-11-13 09:20:10.541454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0
2018-11-13 09:20:10.811436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-13 09:20:10.811473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 
2018-11-13 09:20:10.811479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N 
2018-11-13 09:20:10.811722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10404 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:26:00.0, compute capability: 6.1)
Session started
Iterators created
Creating model
Loading checkpoint
INFO:tensorflow:Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/200/200-8
INFO - tensorflow - Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/200/200-8
Starting training
2018-11-13 09:20:30.977129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 364 of 1000
2018-11-13 09:20:40.820186: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 818 of 1000
2018-11-13 09:20:45.005902: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 09:24:43.171424:	Training iteration: 200, Loss: 0.001660758862271905
2018-11-13 09:28:40.672695:	Training iteration: 400, Loss: 0.0018502550665289164
2018-11-13 09:30:23.521020: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2018-11-13 09:30:33.370435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2018-11-13 09:30:38.502316: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 09:32:48.207132:	Training iteration: 600, Loss: 0.001621853793039918
2018-11-13 09:36:40.815564:	Training iteration: 800, Loss: 0.0016276584938168526
2018-11-13 09:40:13.182369: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-13 09:40:23.209640: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 809 of 1000
2018-11-13 09:40:27.374224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 09:40:34.559962:	Training iteration: 1000, Loss: 0.0018793148919939995
2018-11-13 09:44:20.274354:	Training iteration: 1200, Loss: 0.0021797986701130867
2018-11-13 09:48:07.040036:	Training iteration: 1400, Loss: 0.0019385782070457935
2018-11-13 09:49:42.116285: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 359 of 1000
2018-11-13 09:49:52.157803: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 789 of 1000
2018-11-13 09:49:57.094704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 09:51:58.342325:	Training iteration: 1600, Loss: 0.0019770991057157516
2018-11-13 09:55:45.770413:	Training iteration: 1800, Loss: 0.0017200332367792726
2018-11-13 09:59:32.213517:	Training iteration: 2000, Loss: 0.0015726492274552584
2018-11-13 09:59:35.595204:	Epoch 0 finished after 2016 iterations.
Validating
2018-11-13 09:59:35.788093:	Entering validation loop
2018-11-13 09:59:46.177881: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-13 09:59:56.090977: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 10:00:00.605549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:01:36.209568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-13 10:01:46.213338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-13 10:01:50.661609: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:03:28.085899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-13 10:03:38.171160: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 10:03:42.621092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:04:20.137183:	Validation iteration: 200, Loss: 0.0013850940158590674
2018-11-13 10:05:09.029493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 385 of 1000
2018-11-13 10:05:19.071465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 817 of 1000
2018-11-13 10:05:23.102602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.0014627492270110885
Validation loss has improved!
New best validation cost!
Checkpoint
2018-11-13 10:06:52.681417: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-13 10:07:02.686184: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 841 of 1000
2018-11-13 10:07:06.164008: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:10:44.835671:	Training iteration: 2200, Loss: 0.0018862402066588402
2018-11-13 10:14:39.743071:	Training iteration: 2400, Loss: 0.0021134898997843266
2018-11-13 10:16:37.700605: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2018-11-13 10:16:47.648588: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2018-11-13 10:16:52.853899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:18:34.878932:	Training iteration: 2600, Loss: 0.0015327463624998927
2018-11-13 10:22:29.700077:	Training iteration: 2800, Loss: 0.0016957736806944013
2018-11-13 10:26:11.049554:	Training iteration: 3000, Loss: 0.00155021867249161
2018-11-13 10:26:23.054100: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 381 of 1000
2018-11-13 10:26:33.112419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 813 of 1000
2018-11-13 10:26:37.223835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:30:14.907148:	Training iteration: 3200, Loss: 0.0020173622760921717
2018-11-13 10:34:02.894908:	Training iteration: 3400, Loss: 0.0018644904484972358
2018-11-13 10:36:04.238030: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 363 of 1000
2018-11-13 10:36:14.124948: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 795 of 1000
2018-11-13 10:36:18.610621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:38:07.979021:	Training iteration: 3600, Loss: 0.0015922172460705042
2018-11-13 10:41:57.883420:	Training iteration: 3800, Loss: 0.00179862545337528
2018-11-13 10:45:48.906815:	Training iteration: 4000, Loss: 0.0016771071823313832
2018-11-13 10:46:03.644571:	Epoch 1 finished after 4031 iterations.
Validating
2018-11-13 10:46:03.648231:	Entering validation loop
2018-11-13 10:46:13.672851: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-13 10:46:23.658087: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 10:46:28.014374: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:47:52.828164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2018-11-13 10:48:02.819353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-13 10:48:07.229350: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:49:32.323122: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 377 of 1000
2018-11-13 10:49:42.331406: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2018-11-13 10:49:46.762736: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:50:23.678612:	Validation iteration: 200, Loss: 0.0013608995359390974
2018-11-13 10:51:15.142664: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 388 of 1000
2018-11-13 10:51:25.068313: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 812 of 1000
2018-11-13 10:51:29.503717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.0014578092616700036
Validation loss has improved!
New best validation cost!
Checkpoint
Training complete after 2 epochs.
Finished requested number of epochs.
Final validation loss: 0.0014578092616700036
This was the best validation loss achieved
Starting testing
2018-11-13 10:52:50.460395:	Entering test loop
2018-11-13 10:53:00.732090: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 364 of 1000
2018-11-13 10:53:10.765737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2018-11-13 10:53:15.594629: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:53:19.226365:	Testing iteration: 0, Loss: 0.0010863124625757337
2018-11-13 10:56:21.669759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 289 of 1000
2018-11-13 10:56:30.279203: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 656 of 1000
2018-11-13 10:56:40.295688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 875 of 1000
2018-11-13 10:56:44.146871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 10:59:33.124823: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 305 of 1000
2018-11-13 10:59:43.152306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 730 of 1000
2018-11-13 10:59:50.095991: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 11:02:47.941278: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2018-11-13 11:02:57.932370: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 795 of 1000
2018-11-13 11:03:03.043934: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2018-11-13 11:03:24.290437:	Testing iteration: 200, Loss: 0.001068820245563984
Test pass complete
Mean loss over test set: 0.0012486777277305149
Data saved to dumps/213 for later audio metric calculation
2018-11-13 11:05:59.579694:
	All done with experiment 213!
	Final test loss: 0.0012486777277305149
