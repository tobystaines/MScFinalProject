INFO - UNet_Speech_Separation - Running command 'do_experiment'
INFO - UNet_Speech_Separation - Started run with ID "347"
Experiment ID: 347
Preparing dataset
Dataset ready
2019-02-06 15:04:08.044476: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-02-06 15:04:08.427293: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-06 15:04:08.429216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:26:00.0
totalMemory: 10.91GiB freeMemory: 10.76GiB
2019-02-06 15:04:08.429234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0
2019-02-06 15:04:09.183431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-06 15:04:09.183486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 
2019-02-06 15:04:09.183500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N 
2019-02-06 15:04:09.184335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10403 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:26:00.0, compute capability: 6.1)
Session started
Iterators created
Creating model
Starting training
2019-02-06 15:04:27.932190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 347 of 1000
2019-02-06 15:04:37.960891: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2019-02-06 15:04:42.476606: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:08:37.037642:	Training iteration: 200, Loss: 0.21459951996803284
2019-02-06 15:12:35.352890:	Training iteration: 400, Loss: 0.2218669056892395
2019-02-06 15:14:24.990238: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 15:14:34.898062: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2019-02-06 15:14:39.979874: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:16:48.032202:	Training iteration: 600, Loss: 0.2730930745601654
2019-02-06 15:20:38.115654:	Training iteration: 800, Loss: 0.2640913724899292
2019-02-06 15:24:16.790348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 384 of 1000
2019-02-06 15:24:26.724332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 817 of 1000
2019-02-06 15:24:30.657504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:24:37.906523:	Training iteration: 1000, Loss: 0.27095019817352295
2019-02-06 15:28:48.168019:	Training iteration: 1200, Loss: 0.2796538472175598
2019-02-06 15:32:49.450191:	Training iteration: 1400, Loss: 0.26410967111587524
2019-02-06 15:34:32.014056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 367 of 1000
2019-02-06 15:34:42.044367: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 799 of 1000
2019-02-06 15:34:46.606642: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:36:49.401856:	Training iteration: 1600, Loss: 0.25388088822364807
2019-02-06 15:40:43.584242:	Training iteration: 1800, Loss: 0.2574213445186615
2019-02-06 15:44:35.091505:	Training iteration: 2000, Loss: 0.2513880431652069
2019-02-06 15:44:39.622144:	Epoch 0 finished after 2016 iterations.
Validating
2019-02-06 15:44:39.812944:	Entering validation loop
2019-02-06 15:44:50.335118: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 381 of 1000
2019-02-06 15:45:00.123023: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 807 of 1000
2019-02-06 15:45:04.579275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:46:34.853869: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 385 of 1000
2019-02-06 15:46:44.840372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 806 of 1000
2019-02-06 15:46:49.232416: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:48:18.439276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 382 of 1000
2019-02-06 15:48:28.547105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 814 of 1000
2019-02-06 15:48:32.844297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:49:14.026982:	Validation iteration: 200, Loss: 0.2801857590675354
2019-02-06 15:50:02.151788: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2019-02-06 15:50:12.200552: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 814 of 1000
2019-02-06 15:50:16.512499: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.2731580328905866
Validation loss has improved!
New best validation cost!
Checkpoint
2019-02-06 15:51:43.943481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 397 of 1000
2019-02-06 15:51:53.939532: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 855 of 1000
2019-02-06 15:51:57.263314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 15:55:31.969251:	Training iteration: 2200, Loss: 0.21786265075206757
2019-02-06 15:59:24.504415:	Training iteration: 2400, Loss: 0.22840800881385803
2019-02-06 16:01:27.572268: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 367 of 1000
2019-02-06 16:01:37.543862: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 766 of 1000
2019-02-06 16:01:43.075467: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:03:37.763973:	Training iteration: 2600, Loss: 0.26795023679733276
2019-02-06 16:07:28.637928:	Training iteration: 2800, Loss: 0.26628902554512024
2019-02-06 16:11:13.358774:	Training iteration: 3000, Loss: 0.2645757496356964
2019-02-06 16:11:26.134863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 370 of 1000
2019-02-06 16:11:36.147960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 809 of 1000
2019-02-06 16:11:40.109517: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:15:32.471245:	Training iteration: 3200, Loss: 0.26720014214515686
2019-02-06 16:19:30.426977:	Training iteration: 3400, Loss: 0.2751321792602539
2019-02-06 16:21:25.442937: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 361 of 1000
2019-02-06 16:21:35.468410: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 795 of 1000
2019-02-06 16:21:39.975250: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:23:25.394711:	Training iteration: 3600, Loss: 0.25511056184768677
2019-02-06 16:27:15.743920:	Training iteration: 3800, Loss: 0.25363531708717346
2019-02-06 16:31:08.530274:	Training iteration: 4000, Loss: 0.249549001455307
2019-02-06 16:31:24.483969:	Epoch 1 finished after 4031 iterations.
Validating
2019-02-06 16:31:24.486956:	Entering validation loop
2019-02-06 16:31:34.667095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 372 of 1000
2019-02-06 16:31:44.507989: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 813 of 1000
2019-02-06 16:31:48.779245: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:33:14.136034: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 380 of 1000
2019-02-06 16:33:24.126256: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 817 of 1000
2019-02-06 16:33:28.232866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:34:53.473849: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 376 of 1000
2019-02-06 16:35:03.450067: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 815 of 1000
2019-02-06 16:35:07.732271: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:35:45.384599:	Validation iteration: 200, Loss: 0.2807067036628723
2019-02-06 16:36:35.492929: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 377 of 1000
2019-02-06 16:36:45.547743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 818 of 1000
2019-02-06 16:36:49.502283: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.2730094039191802
Validation loss has improved!
New best validation cost!
Checkpoint
2019-02-06 16:38:20.917817: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 388 of 1000
2019-02-06 16:38:30.861768: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 764 of 1000
2019-02-06 16:38:37.945197: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:41:58.236922:	Training iteration: 4200, Loss: 0.22674661874771118
2019-02-06 16:45:52.812167:	Training iteration: 4400, Loss: 0.20976556837558746
2019-02-06 16:48:13.148087: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2019-02-06 16:48:23.230873: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2019-02-06 16:48:28.311777: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 16:49:59.461549:	Training iteration: 4600, Loss: 0.27104663848876953
2019-02-06 16:53:50.875022:	Training iteration: 4800, Loss: 0.2590946853160858
2019-02-06 16:57:44.916464:	Training iteration: 5000, Loss: 0.255550354719162
2019-02-06 16:58:04.934584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 16:58:14.868375: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 821 of 1000
2019-02-06 16:58:18.749813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:01:51.059386:	Training iteration: 5200, Loss: 0.2680131196975708
2019-02-06 17:05:51.564759:	Training iteration: 5400, Loss: 0.27546894550323486
2019-02-06 17:08:07.086446: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 364 of 1000
2019-02-06 17:08:17.057731: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 794 of 1000
2019-02-06 17:08:21.615314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:09:52.056461:	Training iteration: 5600, Loss: 0.2531057894229889
2019-02-06 17:13:43.267748:	Training iteration: 5800, Loss: 0.2661612629890442
2019-02-06 17:17:38.254864:	Training iteration: 6000, Loss: 0.2556721866130829
2019-02-06 17:18:12.623116:	Epoch 2 finished after 6046 iterations.
Validating
2019-02-06 17:18:12.627630:	Entering validation loop
2019-02-06 17:18:22.845943: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2019-02-06 17:18:32.865889: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 809 of 1000
2019-02-06 17:18:36.875960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:20:02.627214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 380 of 1000
2019-02-06 17:20:12.642633: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 818 of 1000
2019-02-06 17:20:16.614361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:21:41.862266: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 377 of 1000
2019-02-06 17:21:51.883674: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 814 of 1000
2019-02-06 17:21:56.040497: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:22:33.445852:	Validation iteration: 200, Loss: 0.26279592514038086
2019-02-06 17:23:21.787433: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2019-02-06 17:23:31.852378: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 808 of 1000
2019-02-06 17:23:36.149198: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.27309277263425646
Validation loss has worsened. worse_val_checks = 1
Checkpoint
2019-02-06 17:25:03.792321: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2019-02-06 17:25:13.826652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 828 of 1000
2019-02-06 17:25:17.380968: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:28:22.339638:	Training iteration: 6200, Loss: 0.21972008049488068
2019-02-06 17:32:14.470567:	Training iteration: 6400, Loss: 0.22512364387512207
2019-02-06 17:34:55.058510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 17:35:04.973696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 794 of 1000
2019-02-06 17:35:09.956721: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:36:25.202241:	Training iteration: 6600, Loss: 0.26446688175201416
2019-02-06 17:40:21.169460:	Training iteration: 6800, Loss: 0.2734912931919098
2019-02-06 17:44:10.298687:	Training iteration: 7000, Loss: 0.26019585132598877
2019-02-06 17:44:48.575790: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 17:44:58.447254: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 819 of 1000
2019-02-06 17:45:02.059390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:48:07.782615:	Training iteration: 7200, Loss: 0.27059701085090637
2019-02-06 17:52:06.429047:	Training iteration: 7400, Loss: 0.27169540524482727
2019-02-06 17:54:44.875337: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2019-02-06 17:54:54.874219: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 809 of 1000
2019-02-06 17:54:59.172604: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:56:09.579305:	Training iteration: 7600, Loss: 0.25457075238227844
Error: cost = nan
Loading latest checkpoint
INFO:tensorflow:Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/347/347-3
INFO - tensorflow - Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/347/347-3
Training complete after 3 epochs.
Finished requested number of epochs.
Final validation loss: 0.27309277263425646
Best validation loss (0.2730094039191802) achieved at validation check 2
Starting testing
2019-02-06 17:57:46.663256:	Entering test loop
2019-02-06 17:57:56.983779: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 364 of 1000
2019-02-06 17:58:06.984382: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 780 of 1000
2019-02-06 17:58:12.214998: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 17:58:16.079034:	Testing iteration: 0, Loss: 0.27805933356285095
2019-02-06 18:01:41.946155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 364 of 1000
2019-02-06 18:01:51.837877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 734 of 1000
2019-02-06 18:01:58.421099: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 18:05:06.406958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 357 of 1000
2019-02-06 18:05:16.400334: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 773 of 1000
2019-02-06 18:05:22.005621: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 18:08:29.033302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 383 of 1000
2019-02-06 18:08:39.171711: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 796 of 1000
2019-02-06 18:08:43.954823: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 18:09:02.445020:	Testing iteration: 200, Loss: 0.2852402925491333
Test pass complete
Mean loss over test set: 0.2777519206588085
Data saved to dumps/347 for later audio metric calculation
2019-02-06 18:11:39.479474:
	All done with experiment 347!
	Final test loss: 0.2777519206588085
INFO - UNet_Speech_Separation - Completed after 3:10:12
