INFO - UNet_Speech_Separation - Running command 'do_experiment'
INFO - UNet_Speech_Separation - Started run with ID "344"
Experiment ID: 344
Preparing dataset
Dataset ready
2019-02-06 13:00:35.849053: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-02-06 13:00:36.305414: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-06 13:00:36.306448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:26:00.0
totalMemory: 10.91GiB freeMemory: 10.76GiB
2019-02-06 13:00:36.306466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0
2019-02-06 13:00:37.179473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-06 13:00:37.179535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 
2019-02-06 13:00:37.179549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N 
2019-02-06 13:00:37.180383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10403 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:26:00.0, compute capability: 6.1)
Session started
Iterators created
Creating model
Starting training
2019-02-06 13:00:55.657130: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2019-02-06 13:01:05.631338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 827 of 1000
2019-02-06 13:01:09.520338: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:05:01.922278:	Training iteration: 200, Loss: 0.21348710358142853
2019-02-06 13:08:54.823875:	Training iteration: 400, Loss: 0.21682436764240265
2019-02-06 13:10:36.861757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 13:10:46.711581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 794 of 1000
2019-02-06 13:10:51.675536: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:13:06.726450:	Training iteration: 600, Loss: 0.26872164011001587
2019-02-06 13:17:01.307130:	Training iteration: 800, Loss: 0.264038622379303
2019-02-06 13:20:43.459526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 391 of 1000
2019-02-06 13:20:53.520539: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 822 of 1000
2019-02-06 13:20:57.208708: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:21:04.439979:	Training iteration: 1000, Loss: 0.2785087823867798
2019-02-06 13:24:54.233387:	Training iteration: 1200, Loss: 0.2796263098716736
2019-02-06 13:28:53.316273:	Training iteration: 1400, Loss: 0.2814246714115143
2019-02-06 13:30:34.991546: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 383 of 1000
2019-02-06 13:30:44.865555: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 809 of 1000
2019-02-06 13:30:48.913739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:33:05.717647:	Training iteration: 1600, Loss: 0.2548288404941559
2019-02-06 13:36:58.060768:	Training iteration: 1800, Loss: 0.2643849849700928
2019-02-06 13:40:43.713620:	Training iteration: 2000, Loss: 0.2583944797515869
2019-02-06 13:40:48.267181:	Epoch 0 finished after 2016 iterations.
Validating
2019-02-06 13:40:48.457893:	Entering validation loop
2019-02-06 13:40:58.812454: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 381 of 1000
2019-02-06 13:41:08.737548: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 814 of 1000
2019-02-06 13:41:13.162475: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:42:38.554026: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 387 of 1000
2019-02-06 13:42:48.623273: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 821 of 1000
2019-02-06 13:42:52.497385: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:44:18.429522: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 382 of 1000
2019-02-06 13:44:28.452398: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 814 of 1000
2019-02-06 13:44:32.681622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:45:11.913229:	Validation iteration: 200, Loss: 0.27246448397636414
2019-02-06 13:46:00.519779: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 371 of 1000
2019-02-06 13:46:10.513006: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 819 of 1000
2019-02-06 13:46:14.692419: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.2731743419454211
Validation loss has improved!
New best validation cost!
Checkpoint
2019-02-06 13:47:46.876787: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 370 of 1000
2019-02-06 13:47:55.784694: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 683 of 1000
2019-02-06 13:48:02.690490: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:51:39.618720:	Training iteration: 2200, Loss: 0.2301201969385147
2019-02-06 13:55:32.550641:	Training iteration: 2400, Loss: 0.21503612399101257
2019-02-06 13:57:34.847387: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 13:57:44.774978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2019-02-06 13:57:49.815506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 13:59:33.004961:	Training iteration: 2600, Loss: 0.2710614800453186
2019-02-06 14:03:23.944969:	Training iteration: 2800, Loss: 0.26809248328208923
2019-02-06 14:07:10.731683:	Training iteration: 3000, Loss: 0.26780614256858826
2019-02-06 14:07:23.555224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 392 of 1000
2019-02-06 14:07:33.497883: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 831 of 1000
2019-02-06 14:07:37.110290: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:11:27.543706:	Training iteration: 3200, Loss: 0.2663830518722534
2019-02-06 14:15:19.552251:	Training iteration: 3400, Loss: 0.2824861407279968
2019-02-06 14:17:14.426925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 374 of 1000
2019-02-06 14:17:24.422983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 802 of 1000
2019-02-06 14:17:28.666068: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:19:14.596131:	Training iteration: 3600, Loss: 0.2564699947834015
2019-02-06 14:23:01.524829:	Training iteration: 3800, Loss: 0.2619553804397583
2019-02-06 14:26:49.324054:	Training iteration: 4000, Loss: 0.2576102912425995
2019-02-06 14:27:05.518198:	Epoch 1 finished after 4031 iterations.
Validating
2019-02-06 14:27:05.522739:	Entering validation loop
2019-02-06 14:27:15.532975: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 380 of 1000
2019-02-06 14:27:25.571584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 809 of 1000
2019-02-06 14:27:29.903554: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:28:55.154553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 391 of 1000
2019-02-06 14:29:05.138684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 815 of 1000
2019-02-06 14:29:09.275085: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:30:42.583799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 390 of 1000
2019-02-06 14:30:52.379728: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 821 of 1000
2019-02-06 14:30:58.326086: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:31:39.335672:	Validation iteration: 200, Loss: 0.27006053924560547
2019-02-06 14:32:31.223393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 389 of 1000
2019-02-06 14:32:41.218490: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 818 of 1000
2019-02-06 14:32:45.477431: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
Validation check mean loss: 0.2732288127853757
Validation loss has worsened. worse_val_checks = 1
Checkpoint
2019-02-06 14:34:16.464045: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 404 of 1000
2019-02-06 14:34:26.476172: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 856 of 1000
2019-02-06 14:34:29.729749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:37:44.686759:	Training iteration: 4200, Loss: 0.22590644657611847
2019-02-06 14:41:33.562514:	Training iteration: 4400, Loss: 0.215038001537323
2019-02-06 14:43:52.471500: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 379 of 1000
2019-02-06 14:44:02.636107: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 793 of 1000
2019-02-06 14:44:07.703529: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:45:38.487782:	Training iteration: 4600, Loss: 0.264521062374115
Error: cost = nan
Loading latest checkpoint
INFO:tensorflow:Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/344/344-2
INFO - tensorflow - Restoring parameters from /home/enterprise.internal.city.ac.uk/acvn728/checkpoints/344/344-2
Training complete after 2 epochs.
Finished requested number of epochs.
Final validation loss: 0.2732288127853757
Best validation loss (0.2731743419454211) achieved at validation check 1
Starting testing
2019-02-06 14:47:50.240396:	Entering test loop
2019-02-06 14:48:00.543171: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 375 of 1000
2019-02-06 14:48:10.630972: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 791 of 1000
2019-02-06 14:48:15.517141: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:48:19.224778:	Testing iteration: 0, Loss: 0.28000959753990173
2019-02-06 14:51:17.037042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 386 of 1000
2019-02-06 14:51:26.966575: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 816 of 1000
2019-02-06 14:51:31.451718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:54:32.763276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 398 of 1000
2019-02-06 14:54:42.828056: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 818 of 1000
2019-02-06 14:54:47.124161: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:57:49.716196: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 390 of 1000
2019-02-06 14:57:59.680879: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:98] Filling up shuffle buffer (this may take a while): 813 of 1000
2019-02-06 14:58:04.270699: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:136] Shuffle buffer filled.
2019-02-06 14:58:22.545809:	Testing iteration: 200, Loss: 0.2776074707508087
Test pass complete
Mean loss over test set: 0.277941592496175
Data saved to dumps/344 for later audio metric calculation
2019-02-06 15:01:09.075916:
	All done with experiment 344!
	Final test loss: 0.277941592496175
